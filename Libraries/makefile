#------------------------------------------------------------------------------
# STM32 ライブラリ コンパイル用 MAKEFILE
#------------------------------------------------------------------------------


# ライブラリソースをリストアップ
CORE_SRCS := $(wildcard $(CORE_SRC_PATH)*.c)
PERIPH_SRCS := $(wildcard $(PERIPH_SRC_PATH)*.c)
OTHER_SRCS := $(wildcard *.c)
LIB_OBJS := $(CORE_SRCS:%.c=%.o) $(PERIPH_SRCS:%.c=%.o) $(OTHER_SRCS:%.c=%.o)

# 各ヘッダのパスを指定する
CFLAGS += -I .

# ターゲットの指定
all : $(LIB_STM32)
# ライブラリのコンパイル
$(LIB_STM32) : $(LIB_OBJS)
	$(AR) cr $@ $^
%.o : %.c
	$(CC) $(CFLAGS) -c $< -o $@
# 上記以外の依存関係
$(LIB_OBJS) : makefile

#------------------------------------------------------------------------------
# クリーンアップ
#------------------------------------------------------------------------------
clean:
	$(RM) $(LIB_OBJS) $(LIB_STM32)
